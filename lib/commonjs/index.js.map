{"version":3,"sources":["index.tsx"],"names":["ProximiioNative","NativeModules","BufferSize","NotificationMode","NativeAccuracy","ProximiioEvents","Proximiio","NativeEventEmitter","ready","visitorId","location","floor","level","authorize","bind","getContext","subscribe","unsubscribe","state","length","token","authWithToken","PositionUpdated","FloorChanged","currentFloor","currentGeofences","getDepartments","id","getDepartment","getFloor","getFloors","getGeofence","getGeofences","getPlace","getPlaces","buffer","Platform","OS","setBufferSize","requestPermissions","enable","disable","event","fn","emitter","addListener","removeListener","mode","setNotificationMode","title","setNotificationTitle","text","setNotificationText","icon","setNotificationIcon","updateOptions","accuracy","setNativeAccuracy","erase","destroy","instance","ProximiioContext","React","createContext","ProximiioContextProvider","children","context","setContext","contextSetter"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, PropsWithChildren } from 'react';\nimport { NativeModules, NativeEventEmitter, Platform } from 'react-native';\nconst { ProximiioNative } = NativeModules;\n\nimport {\n  ProximiioContextType,\n  ProximiioInitState,\n  ProximiioFloor,\n  ProximiioGeofence,\n  ProximiioDepartment,\n  ProximiioPlace,\n  ProximiioLocation,\n} from './types';\n\nexport enum BufferSize {\n  MINI = 0,\n  SMALL = 1,\n  MEDIUM = 2,\n  LARGE = 3,\n  XLARGE = 4,\n}\n\nexport enum NotificationMode {\n  Disabled = 0,\n  Enabled = 1,\n  Required = 2,\n}\n\nexport enum NativeAccuracy {\n  Cellular = 1,\n  WIFI = 2,\n  GPS = 3,\n  Navigation = 4,\n}\n\nexport enum ProximiioEvents {\n  Initialized = 'ProximiioInitialized',\n  PositionUpdated = 'ProximiioPositionUpdated',\n  FloorChanged = 'ProximiioFloorChanged',\n  EnteredGeofence = 'ProximiioEnteredGeofence',\n  ExitedGeofence = 'ProximiioExitedGeofence',\n  EnteredPrivacyZone = 'ProximiioEnteredPrivacyZone',\n  ExitedPrivacyZone = 'ProximiioExitedPrivacyZone',\n  FoundIBeacon = 'ProximiioFoundIBeacon',\n  UpdatedIBeacon = 'ProximiioUpdatedIBeacon',\n  LostIBeacon = 'ProximiioLostIBeacon',\n  FoundEddystoneBeacon = 'ProximiioFoundEddystoneBeacon',\n  UpdatedEddystoneBeacon = 'ProximiioUpdatedEddystoneBeacon',\n  LostEddystoneBeacon = 'ProximiioLostEddystoneBeacon',\n}\n\nexport class Proximiio {\n  emitter: NativeEventEmitter = new NativeEventEmitter(ProximiioNative);\n  state: ProximiioInitState = {\n    ready: true,\n    visitorId: '',\n  };\n\n  location?: ProximiioLocation;\n  floor?: ProximiioFloor;\n  level = 0;\n\n  constructor() {\n    this.authorize = this.authorize.bind(this);\n    this.getContext = this.getContext.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.unsubscribe = this.unsubscribe.bind(this);\n  }\n\n  isAuthorized() {\n    return this.state.visitorId.length > 0;\n  }\n\n  async authorize(token: string): Promise<ProximiioInitState> {\n    const state = await ProximiioNative.authWithToken(token);\n    this.state.ready = true;\n    this.state.visitorId = state.visitorId;\n    this.subscribe(\n      ProximiioEvents.PositionUpdated,\n      (location: ProximiioLocation) => {\n        this.location = location;\n      }\n    );\n\n    this.subscribe(ProximiioEvents.FloorChanged, (floor: ProximiioFloor) => {\n      this.floor = floor;\n      this.level = floor.level;\n    });\n    return state;\n  }\n\n  async currentFloor(): Promise<ProximiioFloor> {\n    return await ProximiioNative.currentFloor();\n  }\n\n  async currentGeofences(): Promise<ProximiioGeofence[]> {\n    return await ProximiioNative.currentGeofences();\n  }\n\n  getContext = () => {\n    return {\n      location: this.location,\n      floor: this.floor,\n      level: this.floor?.level,\n    } as ProximiioContextType;\n  };\n\n  departments(): Promise<ProximiioDepartment[]> {\n    return ProximiioNative.getDepartments();\n  }\n\n  getDepartment(id: string): Promise<ProximiioDepartment> {\n    return ProximiioNative.getDepartment(id);\n  }\n\n  getFloor(id: string): Promise<ProximiioFloor | null> {\n    return ProximiioNative.getFloor(id);\n  }\n\n  floors(): Promise<ProximiioFloor[]> {\n    return ProximiioNative.getFloors();\n  }\n\n  getGeofence(id: string): Promise<ProximiioGeofence | null> {\n    return ProximiioNative.getGeofence(id);\n  }\n\n  geofences(): Promise<ProximiioGeofence[]> {\n    return ProximiioNative.getGeofences();\n  }\n\n  getPlace(id: string): Promise<ProximiioPlace | null> {\n    return ProximiioNative.getPlace(id);\n  }\n\n  places(): Promise<ProximiioPlace[]> {\n    return ProximiioNative.getPlaces();\n  }\n\n  setBufferSize(buffer: BufferSize) {\n    if (Platform.OS === 'ios') {\n      ProximiioNative.setBufferSize(buffer);\n    }\n  }\n\n  requestPermissions() {\n    ProximiioNative.requestPermissions();\n  }\n\n  enable() {\n    if (Platform.OS === 'ios') {\n      ProximiioNative.enable();\n    }\n  }\n\n  disable() {\n    if (Platform.OS === 'ios') {\n      ProximiioNative.disable();\n    }\n  }\n\n  subscribe(event: string, fn: (data: any) => void) {\n    return this.emitter.addListener(event, fn);\n  }\n\n  unsubscribe(event: string, fn: (data: any) => void) {\n    return this.emitter.removeListener(event, fn);\n  }\n\n  setNotificationMode(mode: NotificationMode) {\n    if (Platform.OS === 'android') {\n      ProximiioNative.setNotificationMode(mode);\n    }\n  }\n\n  setNotificationTitle(title: string) {\n    if (Platform.OS === 'android') {\n      ProximiioNative.setNotificationTitle(title);\n    }\n  }\n\n  setNotificationText(text: string) {\n    if (Platform.OS === 'android') {\n      ProximiioNative.setNotificationText(text);\n    }\n  }\n\n  setNotificationIcon(icon: string) {\n    if (Platform.OS === 'android') {\n      ProximiioNative.setNotificationIcon(icon);\n    }\n  }\n\n  updateOptions() {\n    if (Platform.OS === 'android') {\n      ProximiioNative.updateOptions();\n    }\n  }\n\n  setNativeAccuracy(accuracy: NativeAccuracy) {\n    ProximiioNative.setNativeAccuracy(accuracy);\n  }\n\n  destroy(erase: boolean) {\n    if (Platform.OS === 'android') {\n      ProximiioNative.destroy(erase);\n    } else {\n      ProximiioNative.destroy();\n    }\n  }\n}\n\nconst instance = new Proximiio();\nexport default instance;\n\nexport {\n  ProximiioContextType,\n  ProximiioInitState,\n  ProximiioFloor,\n  ProximiioGeofence,\n  ProximiioDepartment,\n  ProximiioPlace,\n  ProximiioLocation,\n};\n\nexport const ProximiioContext = React.createContext(instance.getContext());\n\nexport const ProximiioContextProvider = ({\n  children,\n}: PropsWithChildren<{}>) => {\n  const [context, setContext] = useState({} as ProximiioContextType);\n\n  useEffect(() => {\n    const contextSetter = () => {\n      setContext(instance.getContext());\n    };\n\n    instance.subscribe(ProximiioEvents.PositionUpdated, contextSetter);\n    instance.subscribe(ProximiioEvents.FloorChanged, contextSetter);\n\n    return () => {\n      instance.unsubscribe(ProximiioEvents.PositionUpdated, contextSetter);\n      instance.unsubscribe(ProximiioEvents.FloorChanged, contextSetter);\n    };\n  }, []);\n\n  return (\n    <ProximiioContext.Provider value={context}>\n      {children}\n    </ProximiioContext.Provider>\n  );\n};\n"]}